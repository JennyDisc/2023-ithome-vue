import{B as g}from"./BackNavbar-d9e0c172.js";import{_,a as u,m as f,r as v,o as n,c as l,d as A,b as t,F as p,h as m,g as h,j as b,i as I,v as x,t as N}from"./index-48e79dc0.js";import{u as R}from"./AdminLoginStore-a1747115.js";const k={data(){return{restaurants:[],addRestaurants:[],inputAddItem:{addBrandName:"",addType:"",addAddress:"",addmapUrl:""},resTypeList:["學生族群","小資族群","精緻族群","頂級族群"],submitShow:!1,isSorting:!1,ascending:!0,apiResUrl:""}},components:{BackNavbar:g},methods:{pocket(){u.get(this.apiResUrl).then(e=>{this.restaurants=e.data,console.log(this.restaurants)}).catch(e=>{console.log(e)})},addResItem(){const e=this.addRestaurants.some(s=>s.brandName==="");console.log(e),e?alert("已有空白列供填寫，請輸入完畢後再新增!"):(this.addRestaurants.push({type:"",brandName:"",address:""}),this.submitShow=!0)},toggleSorting(){this.ascending?(this.ascending=!this.ascending,this.isSorting=!0):this.ascending=!0},resetTable(){this.inputAddItem.addBrandName="",this.inputAddItem.addType="",this.inputAddItem.addAddress=""},submitAddRes(){event.preventDefault(),this.inputAddItem.addType!==""&this.inputAddItem.addBrandName!==""&this.inputAddItem.addAddress!==""?u.get(this.apiResUrl).then(e=>{console.log(e);const s=e.data;console.log(s);const o=s.length;console.log(o);const c=s.some(a=>a.brandName===this.inputAddItem.addBrandName);console.log(c),c?alert("該餐廳已存在!"):(u.post(this.apiResUrl,{type:this.inputAddItem.addType,brandName:this.inputAddItem.addBrandName,address:this.inputAddItem.addAddress,mapUrl:"",id:(o+1).toString()}),alert("餐廳新增成功"),this.submitShow=!1,this.pocket(),this.addRestaurants=[])}).catch(e=>{console.log(e),alert("餐廳新增失敗!")}).finally(()=>{this.resetTable()}):alert("欄位不可空值!")}},created(){this.apiResUrl="http://localhost:3001/restaurants"},mounted(){this.pocket()},computed:{...f(R,{userName:e=>e.name,userEmail:e=>e.email,userId:e=>e.id}),orderByList(){const e=[...this.restaurants];return e.sort((s,o)=>this.ascending?s.type.localeCompare(o.type):o.type.localeCompare(s.type)),e}}},B={class:"container"},S={class:"mb-4 admminRes"},T={class:"d-flex justify-content-end mb-4"},U={class:"table table-bordered table-hover mb-4"},L=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"table-secondary"},"品牌受眾"),t("th",{scope:"col",class:"table-secondary"},"品牌名稱"),t("th",{scope:"col",class:"table-secondary"},"地址")])],-1),w={key:0},C=t("tr",null,[t("td",null,[t("select",{name:"品牌受眾",id:"type",class:"form-select",disabled:"true"},[t("option",{value:"",disabled:"",selected:""},"請選擇品牌受眾")])]),t("td",null,[t("input",{class:"form-control",type:"text",disabled:"true",placeholder:"請輸入品牌名稱"})]),t("td",null,[t("input",{class:"form-control",type:"text",disabled:"true",placeholder:"請輸入餐廳地址"})])],-1),V=[C],D={key:1},j=t("option",{value:"",disabled:"",selected:""},"請選擇品牌受眾",-1),E=["value"],F={key:0,class:"d-flex justify-content-end"},M={class:"mb-4 admminRes"},q={class:"d-flex justify-content-end mb-4"},z={class:"table table-bordered table-hover mb-4"},G=t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"table-secondary"},"品牌受眾"),t("th",{scope:"col",class:"table-secondary"},"品牌名稱"),t("th",{scope:"col",class:"table-secondary"},"地址")])],-1),H=["value"],J=["value"],K=["value"];function O(e,s,o,c,a,r){const y=v("BackNavbar");return n(),l("div",B,[A(y),t("section",S,[t("div",T,[t("button",{type:"button",class:"btn btn-primary me-4",onClick:s[0]||(s[0]=(...d)=>r.addResItem&&r.addResItem(...d))}," 新增餐廳 ")]),t("table",U,[L,a.submitShow?(n(),l("tbody",D,[t("tr",null,[(n(!0),l(p,null,m(a.addRestaurants,d=>(n(),l("td",{key:d},[h(t("select",{name:"品牌受眾",id:"type",class:"form-select","onUpdate:modelValue":s[1]||(s[1]=i=>a.inputAddItem.addType=i)},[j,(n(!0),l(p,null,m(a.resTypeList,i=>(n(),l("option",{value:i,key:i},N(i),9,E))),128))],512),[[x,a.inputAddItem.addType]])]))),128)),t("td",null,[h(t("input",{class:"form-control",type:"text",placeholder:"請輸入品牌名稱","onUpdate:modelValue":s[2]||(s[2]=d=>a.inputAddItem.addBrandName=d)},null,512),[[b,a.inputAddItem.addBrandName]])]),t("td",null,[h(t("input",{class:"form-control",type:"text",placeholder:"請輸入餐廳地址","onUpdate:modelValue":s[3]||(s[3]=d=>a.inputAddItem.addAddress=d)},null,512),[[b,a.inputAddItem.addAddress]])])])])):(n(),l("tbody",w,V))]),a.submitShow?(n(),l("div",F,[t("button",{class:"btn btn-lg btn-secondary",type:"submit",onClick:s[4]||(s[4]=d=>r.submitAddRes())}," 送出 ")])):I("",!0)]),t("section",M,[t("div",q,[t("button",{type:"button",class:"btn btn-warning",onClick:s[5]||(s[5]=(...d)=>r.toggleSorting&&r.toggleSorting(...d))}," 依品牌受眾排序 ")]),t("table",z,[G,t("tbody",null,[(n(!0),l(p,null,m(a.isSorting?r.orderByList:a.restaurants,d=>(n(),l("tr",{key:d},[t("td",null,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:d.type},null,8,H)]),t("td",null,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:d.brandName},null,8,J)]),t("td",null,[t("input",{type:"text",readonly:"",class:"form-control-plaintext",value:d.address},null,8,K)])]))),128))])])])])}const X=_(k,[["render",O]]);export{X as default};
